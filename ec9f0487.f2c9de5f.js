(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{206:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return b}));var r=a(3),n=a(7),i=(a(0),a(230)),o={title:"\u4e0a\u624b\u6307\u5357"},c={unversionedId:"opensource-projects/ue4/getting-started",id:"opensource-projects/ue4/getting-started",isDocsHomePage:!1,title:"\u4e0a\u624b\u6307\u5357",description:"Geometry Brush Actors",source:"@site/docs\\opensource-projects\\ue4\\getting-started.md",slug:"/opensource-projects/ue4/getting-started",permalink:"/dddtdd-docs/docs/opensource-projects/ue4/getting-started",version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1616755928,sidebar:"docs",previous:{title:"UE4\u4ecb\u7ecd",permalink:"/dddtdd-docs/docs/opensource-projects/ue4/"}},s=[{value:"Geometry Brush Actors",id:"geometry-brush-actors",children:[]},{value:"Unreal Objects (UObject)",id:"unreal-objects-uobject",children:[]},{value:"AActor",id:"aactor",children:[]},{value:"UActorComponent",id:"uactorcomponent",children:[]},{value:"UStruct",id:"ustruct",children:[]},{value:"Unreal Reflection System",id:"unreal-reflection-system",children:[]},{value:"UObjects and Garbage Collection",id:"uobjects-and-garbage-collection",children:[]},{value:"Actors and Garbage Collection",id:"actors-and-garbage-collection",children:[]},{value:"Class Naming Prefixes",id:"class-naming-prefixes",children:[]},{value:"Strings",id:"strings",children:[]},{value:"Containers",id:"containers",children:[]},{value:"The UCLASS Macro",id:"the-uclass-macro",children:[]},{value:"The Unreal Header Tool",id:"the-unreal-header-tool",children:[]},{value:"Encoding",id:"encoding",children:[]},{value:"BehaviorTreeQuickStart",id:"behaviortreequickstart",children:[]},{value:"Reliable RPC and Disconnect",id:"reliable-rpc-and-disconnect",children:[]},{value:"Timer",id:"timer",children:[]},{value:"Replication Prioritization",id:"replication-prioritization",children:[]},{value:"RPC",id:"rpc",children:[]},{value:"Stably Named Objects",id:"stably-named-objects",children:[]}],l={rightToc:s};function b(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"geometry-brush-actors"},"Geometry Brush Actors"),Object(i.b)("p",null,Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.unrealengine.com/en-US/Basics/Actors/Brushes/index.html"}),"https://docs.unrealengine.com/en-US/Basics/Actors/Brushes/index.html")),Object(i.b)("p",null,"level\u8bbe\u8ba1\u7528Static Meshes\u6548\u7387\u66f4\u9ad8\uff0cGeometry Brushes\u9002\u5408\u5728\u521d\u671f\u505a\u539f\u578b\u65f6\u5019\u4f7f\u7528"),Object(i.b)("h2",{id:"unreal-objects-uobject"},"Unreal Objects (UObject)"),Object(i.b)("p",null,"The base building block in the Engine is called UObject. This class, coupled with UClass, provides a number of the Engine's most important services:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Reflection of properties and methods"),Object(i.b)("li",{parentName:"ul"},"Serialization of properties"),Object(i.b)("li",{parentName:"ul"},"Garbage collection"),Object(i.b)("li",{parentName:"ul"},"Finding a UObject by name"),Object(i.b)("li",{parentName:"ul"},"Configurable values for properties"),Object(i.b)("li",{parentName:"ul"},"Networking support for properties and methods")),Object(i.b)("p",null,"Each class that derives from UObject has a singleton UClass created for it that contains all of the metadata about the class instance. UObject and UClass together are at the root of everything that a gameplay object does during its lifetime. The best way to think of the difference between a UClass and a UObject is that the UClass describes what an instance of a UObject will look like, what properties are available for serialization, networking, and so on. "),Object(i.b)("h2",{id:"aactor"},"AActor"),Object(i.b)("p",null,"All objects that can be placed into a level extend from this class. AActor is also the base type that can be replicated during networking."),Object(i.b)("p",null,"Actors have their own behaviors (specialization through inheritance), but they also act as containers for a hierarchy of Actor Components (specialization through composition). This is done through the Actor's RootComponent member, which contains a single USceneComponent that, in turn, can contain many others. Before an Actor can be placed in a level, it must contain at least one Scene Component, from which the Actor will draw its translation, rotation, and scale."),Object(i.b)("p",null,"Spawning an actor is a bit more complicated than creating a normal object in the game, because Actors need to be registered with a variety of runtime systems in order to serve all of their needs. The initial location and rotation for an Actor need to be set. Physics may need to know about it. The manager responsible for telling an Actor to tick needs to know. And so on. Because of this, we have a method devoted to the spawning of an Actor, SpawnActor (a member of UWorld). "),Object(i.b)("h2",{id:"uactorcomponent"},"UActorComponent"),Object(i.b)("p",null,"Actor Components (class UActorComponent) have their own behaviors and are usually responsible for functionality that is shared across many types of Actors, such as providing visual meshes, particle effects, camera perspectives, and physics interactions."),Object(i.b)("h2",{id:"ustruct"},"UStruct"),Object(i.b)("p",null,"A UStruct should be a plain data type that has UObject reflection support for editing within the Unreal Editor, Blueprint manipulation, serialization, networking, and so on."),Object(i.b)("h2",{id:"unreal-reflection-system"},"Unreal Reflection System"),Object(i.b)("p",null,"Gameplay classes make use of special markup, so before we go over them, let us cover some of the basics of the Unreal property system. UE4 uses its own implementation of reflection that enables dynamic features such as garbage collection, serialization, network replication, and Blueprint/C++ communication. These features are opt-in, meaning you have to add the correct markup to your types, otherwise Unreal will ignore them and not generate the reflection data for them. Here is a quick overview of the basic markup:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"UCLASS() \u2014 Used to tell Unreal to generate reflection data for a class. The class must derive from UObject."),Object(i.b)("li",{parentName:"ul"},"USTRUCT() \u2014 Used to tell Unreal to generate reflection data for a struct."),Object(i.b)("li",{parentName:"ul"},"GENERATED_BODY() \u2014 UE4 replaces this with all the necessary boilerplate code that gets generated for the type."),Object(i.b)("li",{parentName:"ul"},"UPROPERTY() \u2014 Enables a member variable of a UCLASS or a USTRUCT to be used as a UPROPERTY. A UPROPERTY has many uses. It can allow the variable to be replicated, serialized, and accessed from Blueprints. They are also used by the garbage collector to keep track of how many references there are to a UObject."),Object(i.b)("li",{parentName:"ul"},"UFUNCTION() \u2014 Enables a class method of a UCLASS or a USTRUCT to be used as a UFUNCTION. A UFUNCTION can allow the class method to be called from Blueprints and used as RPCs, among other things.")),Object(i.b)("p",null,"You'll first notice the inclusion of MyObject.generated.h. UE4 will generate all the reflection data and put it into this file. You must include this file as the last include in the header file that declares your type."),Object(i.b)("h2",{id:"uobjects-and-garbage-collection"},"UObjects and Garbage Collection"),Object(i.b)("p",null,"In the garbage collector, there is a concept called the root set. The root set is a list of objects that the collector knows will never be garbage collected."),Object(i.b)("h2",{id:"actors-and-garbage-collection"},"Actors and Garbage Collection"),Object(i.b)("p",null,"Actors are not usually garbage collected, aside from during a Level's shutdown. Once spawned, you must manually call Destroy on them to remove them from the Level without ending the Level."),Object(i.b)("p",null,"Since Actors are automatically a part of the root set, SafeObject will not be garbage collected because it can be reached from a root set object. DoomedObject, however, will not fare so well."),Object(i.b)("p",null,"When a UObject is garbage collected, all UPROPERTY references to it will be set to null for you. This makes it safe for you to check if an object has been garbage collected or not."),Object(i.b)("h2",{id:"class-naming-prefixes"},"Class Naming Prefixes"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Classes derived from Actor prefixed with A, such as AController."),Object(i.b)("li",{parentName:"ul"},"Classes derived from Object are prefixed with U, such as UComponent."),Object(i.b)("li",{parentName:"ul"},"Enums are prefixed with E, such as EFortificationType."),Object(i.b)("li",{parentName:"ul"},"Interface classes are usually prefixed with I, such as IAbilitySystemInterface."),Object(i.b)("li",{parentName:"ul"},"Template classes are prefixed by T, such as TArray."),Object(i.b)("li",{parentName:"ul"},"Classes that derive from SWidget (Slate UI) are prefixed by S, such as SButton."),Object(i.b)("li",{parentName:"ul"},"Everything else is prefixed by the letter F , such as FVector.")),Object(i.b)("h2",{id:"strings"},"Strings"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"FString: FString is a mutable string, analogous to std::string. FString has a large suite of methods for making it easy to work with strings. To create a new FString, use the TEXT macro"),Object(i.b)("li",{parentName:"ul"},"FText: FText is similar to FString, but it is meant for localized text. To create a new FText, use the NSLOCTEXT macro. This macro takes a namespace, key, and a value for the default language"),Object(i.b)("li",{parentName:"ul"},"FName: An FName stores a commonly recurring string as an identifier in order to save memory and CPU time when comparing them."),Object(i.b)("li",{parentName:"ul"},"TCHAR: The TCHAR type is used as a way of storing characters independent of the character set being used, which may differ between platforms. Under the hood, UE4 strings use TCHAR arrays to store data in the UTF-16 encoding. You can access the raw data by using the overloaded dereference operator, which returns TCHAR.")),Object(i.b)("h2",{id:"containers"},"Containers"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"TArray: the primary container you'll use in Unreal Engine 4 is TArray, it functions much like std::vector does, but offers a lot more functionality"),Object(i.b)("li",{parentName:"ul"},"TMap: A TMap is a collection of key-value pairs, similar to std::map. TMap has quick methods for finding, adding, and removing elements based on their key."),Object(i.b)("li",{parentName:"ul"},"TSet: A TSet stores a collection of unique values, similar to std::set")),Object(i.b)("h2",{id:"the-uclass-macro"},"The UCLASS Macro"),Object(i.b)("p",null,"The UCLASS macro gives the UObject a reference to a UCLASS that describes its Unreal-based type. Each UCLASS maintains one Object called the 'Class Default Object', or CDO for short. The CDO is essentially a default 'template' Object, generated by the class constructor and unmodified thereafter"),Object(i.b)("h2",{id:"the-unreal-header-tool"},"The Unreal Header Tool"),Object(i.b)("p",null,"In order to harness the functionality provided by UObject-derived types, a preprocessing step needs to be run on the header files for these types in order to collate the information it needs. This preprocessing step is performed by the UnrealHeaderTool, or UHT for short."),Object(i.b)("h2",{id:"encoding"},"Encoding"),Object(i.b)("p",null,"In general, you should be using the TEXT() macro when setting string variable literals. If you do not specify the TEXT() macro, your literal will be encoded using ANSI, which is highly limited in what characters it supports. Any ANSI literals being passed into FString need to undergo a conversion to TCHAR (native Unicode encoding), so it is more efficient to use TEXT()."),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(r.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(r.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(r.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(r.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(r.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"The wheel Physics Bodies are never actually used for collision. Currently, the wheels use a ray casting for interacting with the world."))),Object(i.b)("h2",{id:"behaviortreequickstart"},"BehaviorTreeQuickStart"),Object(i.b)("p",null,Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.unrealengine.com/en-US/InteractiveExperiences/ArtificialIntelligence/BehaviorTrees/BehaviorTreeQuickStart/index.html"}),"https://docs.unrealengine.com/en-US/InteractiveExperiences/ArtificialIntelligence/BehaviorTrees/BehaviorTreeQuickStart/index.html")),Object(i.b)("p",null,"Composites are a form of flow control and determine how ",Object(i.b)("strong",{parentName:"p"},"the child branches")," that are connected to them execute"),Object(i.b)("h2",{id:"reliable-rpc-and-disconnect"},"Reliable RPC and Disconnect"),Object(i.b)("p",null,"Because HandleFire has the Reliable specifier as well, it is placed into a queue for reliable RPCs whenever it gets called, and it is removed from the queue when the server successfully receives it. This guarnatees that the server will definitely receive this function call. However, the queue for reliable RPCs can overflow if too many RPCs are placed into it at once without removing them, and if it does then it will force the user to ",Object(i.b)("strong",{parentName:"p"},"disconnect"),"."),Object(i.b)("p",null,Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.unrealengine.com/en-US/InteractiveExperiences/Networking/Actors/Properties/index.html"}),"https://docs.unrealengine.com/en-US/InteractiveExperiences/Networking/Actors/Properties/index.html")),Object(i.b)("p",null,"Actor property replication is reliable. "),Object(i.b)("p",null,"\u56e0\u4e3aactor\u540c\u6b65\u65f6\u5019\u4f1a\u6839\u636erelevance\u6765\u9009\u62e9\uff0c\u8bf4\u660e\u4e0d\u7528\u540c\u6b65\u5168\u90e8\u7684actors\uff0c\u90a3\u662f\u5426\u53ef\u80fd\u56e0\u4e3a\u7f51\u7edc\u6545\u969c\u5bfc\u81f4actor destroy\u6ca1\u6536\u5230\u7136\u540e\u540e\u9762\u53c8\u6b63\u5e38\u540c\u6b65\u5462\uff1f"),Object(i.b)("h2",{id:"timer"},"Timer"),Object(i.b)("p",null,Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.unrealengine.com/en-US/InteractiveExperiences/UseTimers/index.html"}),"https://docs.unrealengine.com/en-US/InteractiveExperiences/UseTimers/index.html")),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-cpp"}),"    UWorld* World = GetWorld();\n        World->GetTimerManager().SetTimer(FiringTimer, this, &ANetworkingStudyCharacter::StopFire, FireRate, false);\n")),Object(i.b)("h2",{id:"replication-prioritization"},"Replication Prioritization"),Object(i.b)("p",null,"Each Actor has a floating point variable called NetPriority. ",Object(i.b)("strong",{parentName:"p"},"The higher the number, the more bandwidth that Actor receives relative to others"),". An Actor with a priority of 2.0 will be updated exactly twice as frequently as an Actor with priority 1.0. The only thing that matters with priorities is their ratio; so obviously you cannot improve Unreal's network performance by increasing all of ..."),Object(i.b)("p",null,"To avoid starvation AActor::GetNetPriority() multiplies NetPriority with the time since the Actor was last replicated."),Object(i.b)("h2",{id:"rpc"},"RPC"),Object(i.b)("p",null,Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.unrealengine.com/en-US/InteractiveExperiences/Networking/Actors/RPCs/index.html"}),"https://docs.unrealengine.com/en-US/InteractiveExperiences/Networking/Actors/RPCs/index.html")),Object(i.b)("h2",{id:"stably-named-objects"},"Stably Named Objects"),Object(i.b)("p",null,"Actors are stably named if they were loaded directly from packages (not spawned during gameplay)."))}b.isMDXComponent=!0},230:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p}));var r=a(0),n=a.n(r);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=n.a.createContext({}),b=function(e){var t=n.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},d=function(e){var t=b(e.components);return n.a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},u=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=b(a),u=r,p=d["".concat(o,".").concat(u)]||d[u]||h[u]||i;return a?n.a.createElement(p,c(c({ref:t},l),{},{components:a})):n.a.createElement(p,c({ref:t},l))}));function p(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=a[l];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);